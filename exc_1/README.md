# Упражнение 1. 
## Создать Terraform скрипт. 

### Цель.
1. Реализовать терраформ для разворачивания одной виртуалки в yandex-cloud
2. Запровиженить nginx с помощью ansible. 

## Выполнение. 

## 1. Создание скрипта терраформ. 

**main.tf** - конфигурационный файл, в котором создается инстанс на ОС debian с двумя процессорными ядрами, 2 Гб RAM и 10 Gb HDD. \
**outputs.tf** - переменные для вывода внутреннего и внешнего ip. 

В процессе раскатки инстанса, на него отправляется публичный ключ из ~/.ssh/. Создать пользователя sudo со своим ключом в момент установки не получилось. Поэтому ключ кладется для пользователя, установленного по умолчанию, ***debian***. 

## 2. Установка nginx с помощь ansible. 

Установка nginx производится с помощью ansible, плэйбук для установки *provision.yml*. Вызов плэя осуществлен в блоке *provisioner*, как локально запускаемая команда ***local-exec***. Так как, ***local-exec*** может выполниться, не дожидаясь запуска сервера, было использован первоначальный запуск в ***remote-exec***, которая запускается гарантировано после запуска сервера. В данном случае выполнено обновление списка реп (что никогда не будет лишним). 

С помощью playbook устанавливается nginx, запускается и добавляется в автозагрузку соответствующая служба. По итогу на внешнем ip адресе, получаем работающий сервер. 

![NGINX работает и это очень хорошо](./screen/nginx_is_working.png)





